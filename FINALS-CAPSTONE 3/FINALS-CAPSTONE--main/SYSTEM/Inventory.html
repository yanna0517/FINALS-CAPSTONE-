<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AUG DEPT.</title>
  <link rel="icon" type="image/x-icon" href="https://placehold.co/32x32/FFFFFF/000000?text=AD">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Alfa+Slab+One&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .font-alfa { font-family: 'Alfa Slab One', cursive; text-shadow: 1px 1px 1px rgba(0,0,0,0.06); }
    .modal-open { overflow: hidden; }
    .low-stock { background-color: #fee2e2; }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

  <div class="h-screen flex overflow-hidden">
    <!-- Sidebar -->
    <aside class="w-64 bg-gray-800 text-white flex flex-col border-r border-gray-700 flex-shrink-0">
  <div class="h-20 flex items-center justify-center border-b border-gray-700">
    <h1 class="font-alfa text-4xl tracking-wider text-white">AUG DEPT.</h1>
  </div>

  <nav class="flex-1 px-4 py-6 space-y-2">
    <a href="Dashboard.html" class="sidebar-link flex items-center py-2.5 px-4 rounded-lg hover:bg-gray-700 transition-all duration-300 ease-in-out hover:scale-105">
      Dashboard
    </a>
    <a href="Sales.html" class="sidebar-link flex items-center py-2.5 px-4 rounded-lg hover:bg-gray-700 transition-all duration-300 ease-in-out hover:scale-105">
      Sales
    </a>
    <a href="Inventory.html" class="sidebar-link flex items-center py-2.5 px-4 rounded-lg bg-gray-900 text-white transition-all duration-300 ease-in-out hover:bg-gray-700 hover:scale-105">
      Inventory
    </a>
  </nav>

  <div class="px-4 py-6 border-t border-gray-700">
    <a href="index.html" class="sidebar-link flex items-center py-2.5 px-4 rounded-lg hover:bg-gray-700 transition-all duration-300 ease-in-out hover:scale-105">
      Logout
    </a>
  </div>
</aside>

<script>
  // Add fade-out transition when clicking a sidebar link
  const links = document.querySelectorAll('.sidebar-link');

  links.forEach(link => {
    link.addEventListener('click', function (e) {
      e.preventDefault(); // stop instant navigation
      document.body.classList.add('opacity-0', 'transition-opacity', 'duration-100');
      setTimeout(() => {
        window.location = this.href; // navigate after fade-out
      }, 400); // wait for animation to finish
    });
  });

  // Fade-in effect when the page loads
  window.addEventListener('load', () => {
    document.body.classList.remove('opacity-0');
    document.body.classList.add('opacity-100', 'transition-opacity', 'duration-100');
  });
</script>

    <!-- Main content -->
    <main class="flex-1 p-8 overflow-y-auto bg-gray-50">
      <h2 class="text-3xl font-bold mb-8">Inventory</h2>

      <!-- Search + Filter -->
      <div class="flex flex-wrap gap-4 items-center mb-6">
        <input id="searchInput" type="text" placeholder="Search category or product" 
          class="w-full md:w-1/3 px-4 py-2 border border-black rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">

        <select id="categoryFilter" class="w-full md:w-1/4 px-4 py-2 border border-black rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
          <option value="all">All Categories</option>
          <option value="clothing">Clothing</option>
          <option value="accessories">Accessories</option>
          <option value="outdoor">Outdoor</option>
          <option value="fragrance">Fragrance</option>
        </select>

        <div class="ml-auto">
          <button id="openAddBtn" class="px-4 py-2 bg-white text-gray-700 border border-black rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 font-medium">
            Add Product
          </button>
        </div>
      </div>

      <!-- Table -->
      <div class="border border-black rounded-lg overflow-hidden flex-1 overflow-y-auto bg-white">
        <div class="flex text-sm font-semibold text-gray-600 bg-gray-50 px-6 py-3 border-b border-black bg-white">
          <div class="w-1/5">Category</div>
          <div class="w-1/4">Product</div>
          <div class="w-1/5">Quantity</div>
          <div class="w-1/5">Total</div>
          <div class="w-1/6 text-right">Actions</div>
        </div>

        <div id="inventoryTable" class="divide-y divide-gray-200 min-h-[120px]">
          <div id="emptyHint" class="px-6 py-8 text-center text-gray-500">
            No products yet â€” click <strong>Add Product</strong> to create your first item.
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Add/Edit Modal -->
  <div id="productModal" class="fixed inset-0 z-40 hidden items-center justify-center px-4">
    <div class="absolute inset-0 bg-black/40"></div>
    <div class="relative bg-white rounded-2xl shadow-xl w-full max-w-lg mx-auto z-50 p-6">
      <h3 id="modalTitle" class="text-xl font-semibold mb-4">Add Product</h3>

      <form id="productForm" class="space-y-4" onsubmit="return false;">
        <div>
          <label class="block text-sm font-medium text-gray-700">Category</label>
          <input id="prodCategory" list="categoryList" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" />
          <datalist id="categoryList">
            <option value="Clothing">Clothing</option>
            <option value="Accessories">Accessories</option>
            <option value="Outdoor">Outdoor</option>
            <option value="Fragrance">Fragrance</option>
          </datalist>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Product</label>
          <select id="prodName" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
            <option value="">Select product</option>
          </select>
        </div>

        <!-- ðŸ‘• Size Dropdown (for Clothing) -->
        <div id="sizeContainer" class="hidden">
          <label class="block text-sm font-medium text-gray-700">Size</label>
          <select id="prodSize" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
            <option value="">Select size</option>
            <option value="Small">Small</option>
            <option value="Medium">Medium</option>
            <option value="Large">Large</option>
          </select>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">Quantity</label>
            <input id="prodQty" type="number" min="0" value="1" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Total (â‚±)</label>
            <input id="prodTotal" type="number" min="0" step="0.01" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" />
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-2">
          <button type="button" id="cancelModalBtn" class="px-4 py-2 rounded-md bg-white border border-gray-300 hover:bg-gray-50">Cancel</button>
          <button type="submit" id="saveProductBtn" class="px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700">Add</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Delete Modal -->
  <div id="deleteModal" class="fixed inset-0 z-50 hidden items-center justify-center px-4">
    <div class="absolute inset-0 bg-black/40"></div>
    <div class="relative bg-white rounded-2xl shadow-xl w-full max-w-md mx-auto z-50 p-6">
      <h3 class="text-lg font-semibold mb-2">Confirm Delete</h3>
      <p id="deleteMessage" class="text-sm text-gray-600">Are you sure you want to delete this product?</p>
      <div class="flex justify-end gap-3 pt-6">
        <button id="cancelDeleteBtn" class="px-4 py-2 rounded-md bg-white border border-gray-300 hover:bg-gray-50">No</button>
        <button id="confirmDeleteBtn" class="px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-700">Yes, delete</button>
      </div>
    </div>
  </div>

  <script>
    const PRODUCT_OPTIONS = {
      clothing: [
        { name: "White Shirt", price: 499 },
        { name: "Black Shirt", price: 599 },
        { name: "Brown Shirt", price: 599 }
      ],
      accessories: [
        { name: "Cap", price: 100 },
        { name: "Belt", price: 150 },
        { name: "Necklace", price: 250 }
      ],
      outdoor: [
        { name: "Umbrella", price: 200 },
        { name: "Camping Chair", price: 799 },
        { name: "Backpack", price: 400 }
      ],
      fragrance: [
        { name: "Perfume", price: 500 },
        { name: "Cologne", price: 300 },
        { name: "Body Spray", price: 250 }
      ]
    };

    const LOW_STOCK_THRESHOLD = 5;
    const openAddBtn = document.getElementById('openAddBtn');
    const productModal = document.getElementById('productModal');
    const productForm = document.getElementById('productForm');
    const saveProductBtn = document.getElementById('saveProductBtn');
    const cancelModalBtn = document.getElementById('cancelModalBtn');
    const prodName = document.getElementById('prodName');
    const prodCategory = document.getElementById('prodCategory');
    const prodQty = document.getElementById('prodQty');
    const prodTotal = document.getElementById('prodTotal');
    const inventoryTable = document.getElementById('inventoryTable');
    const emptyHint = document.getElementById('emptyHint');
    const deleteModal = document.getElementById('deleteModal');
    const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
    const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
    const searchInput = document.getElementById('searchInput');
    const categoryFilter = document.getElementById('categoryFilter');
    const modalTitle = document.getElementById('modalTitle');

    let editingId = null;
    let deleteTargetId = null;

    function getInventoryData() {
      try { return JSON.parse(localStorage.getItem('inventoryData')) || []; }
      catch { return []; }
    }
    function setInventoryData(arr) { localStorage.setItem('inventoryData', JSON.stringify(arr)); }

    function openModal(m) { m.classList.remove('hidden'); m.style.display = 'flex'; document.body.classList.add('modal-open'); }
    function closeModal(m) { m.classList.add('hidden'); m.style.display = ''; document.body.classList.remove('modal-open'); }

    function resetForm() {
      productForm.reset();
      editingId = null;
      modalTitle.textContent = 'Add Product';
      saveProductBtn.textContent = 'Add';
      prodName.innerHTML = `<option value="">Select product</option>`;
      document.getElementById('sizeContainer').classList.add('hidden');
    }

    prodCategory.addEventListener('change', () => {
      const cat = prodCategory.value.toLowerCase();
      const sizeContainer = document.getElementById('sizeContainer');
      prodName.innerHTML = `<option value="">Select product</option>`;

      // ðŸ‘• Show size dropdown for clothing
      if (cat === 'clothing') {
        sizeContainer.classList.remove('hidden');
      } else {
        sizeContainer.classList.add('hidden');
        document.getElementById('prodSize').value = '';
      }

      if (PRODUCT_OPTIONS[cat]) {
        PRODUCT_OPTIONS[cat].forEach(p => {
          const opt = document.createElement('option');
          opt.value = p.name.toLowerCase();
          opt.textContent = p.name;
          prodName.appendChild(opt);
        });
      }
    });

    function updateTotal() {
      const cat = prodCategory.value.toLowerCase();
      const product = prodName.value;
      const qty = Number(prodQty.value);
      const selected = PRODUCT_OPTIONS[cat]?.find(p => p.name.toLowerCase() === product);
      prodTotal.value = selected ? selected.price * qty : 0;
    }

    prodName.addEventListener('change', updateTotal);
    prodQty.addEventListener('input', updateTotal);

    function createRow(item) {
      const row = document.createElement('div');
      row.className = 'flex items-center px-6 py-4 inventory-row';
      row.dataset.id = item.id;
      row.dataset.category = (item.category || '').toLowerCase();
      const low = Number(item.quantity) < LOW_STOCK_THRESHOLD ? 'low-stock' : '';
      row.innerHTML = `
        <div class="w-1/5 ${low} text-sm">${capitalize(item.category)}</div>
        <div class="w-1/4 ${low}">${escapeHtml(item.product)} ${item.size ? '(' + escapeHtml(item.size) + ')' : ''}</div>
        <div class="w-1/5 ${low} text-sm">${item.quantity}</div>
        <div class="w-1/5 ${low} text-sm">â‚±${Number(item.total).toFixed(2)}</div>
        <div class="w-1/6 text-right">
          <button class="editBtn px-3 py-1.5 border rounded-md text-sm mr-2">Edit</button>
          <button class="deleteBtn px-3 py-1.5 border rounded-md text-sm text-red-600">Delete</button>
        </div>
      `;
      row.querySelector('.editBtn').addEventListener('click', () => openEdit(item.id));
      row.querySelector('.deleteBtn').addEventListener('click', () => openDelete(item.id));
      return row;
    }

    function renderInventory() {
      inventoryTable.querySelectorAll('.inventory-row').forEach(n => n.remove());
      const data = getInventoryData();
      if (!data.length) { emptyHint.style.display = ''; return; }
      emptyHint.style.display = 'none';
      data.forEach(d => inventoryTable.appendChild(createRow(d)));
      applyFilters();
    }

    function openEdit(id) {
      const all = getInventoryData();
      const item = all.find(i => i.id === id);
      if (!item) return;
      editingId = id;
      modalTitle.textContent = 'Edit Product';
      saveProductBtn.textContent = 'Save';
      prodCategory.value = capitalize(item.category);
      prodCategory.dispatchEvent(new Event('change'));
      setTimeout(() => { prodName.value = item.product.toLowerCase(); }, 100);
      prodQty.value = item.quantity;
      prodTotal.value = item.total;
      document.getElementById('prodSize').value = item.size || '';
      openModal(productModal);
    }

    function openDelete(id) {
      deleteTargetId = id;
      openModal(deleteModal);
    }

    productForm.addEventListener('submit', () => {
      const product = prodName.options[prodName.selectedIndex].text;
      const category = prodCategory.value.trim();
      const size = document.getElementById('prodSize').value || '';
      const quantity = Number(prodQty.value);
      const total = Number(prodTotal.value);
      if (!product || !category) return alert('Please fill all fields.');

      const all = getInventoryData();

      if (editingId) {
        const idx = all.findIndex(i => i.id === editingId);
        all[idx] = { ...all[idx], product, category, size, quantity, total };
      } else {
        const existing = all.find(
          i => i.product.toLowerCase() === product.toLowerCase() && i.category.toLowerCase() === category.toLowerCase() && i.size === size
        );

        if (existing) {
          existing.quantity += quantity;
          existing.total += total;
        } else {
          all.push({ id: Date.now().toString(), product, category, size, quantity, total });
        }
      }

      setInventoryData(all);
      closeModal(productModal);
      resetForm();
      renderInventory();
    });

    openAddBtn.addEventListener('click', () => { resetForm(); openModal(productModal); });
    cancelModalBtn.addEventListener('click', () => closeModal(productModal));
    confirmDeleteBtn.addEventListener('click', () => {
      const all = getInventoryData().filter(i => i.id !== deleteTargetId);
      setInventoryData(all);
      closeModal(deleteModal);
      renderInventory();
    });
    cancelDeleteBtn.addEventListener('click', () => closeModal(deleteModal));

    function applyFilters() {
      const s = searchInput.value.toLowerCase().trim();
      const cat = categoryFilter.value.toLowerCase();
      const rows = document.querySelectorAll('.inventory-row');
      rows.forEach(row => {
        const category = row.dataset.category;
        const text = row.textContent.toLowerCase();
        const matchSearch = text.includes(s);
        const matchCat = cat === 'all' || category === cat;
        row.style.display = matchSearch && matchCat ? '' : 'none';
      });
    }

    searchInput.addEventListener('input', applyFilters);
    categoryFilter.addEventListener('change', applyFilters);

    function capitalize(str) { return str.charAt(0).toUpperCase() + str.slice(1); }
    function escapeHtml(str) { return str.replace(/[&<>"']/g, m => ({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])); }

    renderInventory();
  </script>
</body>
</html>
